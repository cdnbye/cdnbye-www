(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{893:function(e,t,n){"use strict";n.r(t);var a=n(1),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:"create-instance"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#create-instance"}},[e._v("#")]),e._v(" Create instance")]),e._v(" "),n("h3",{attrs:{id:"var-engine-new-p2penginefile-url-p2pconfig"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#var-engine-new-p2penginefile-url-p2pconfig"}},[e._v("#")]),e._v(" var engine = new P2PEngineFile(url, p2pConfig);")]),e._v(" "),n("p",[e._v("Create a new "),n("em",[n("strong",[e._v("P2PEngineFile")])]),e._v(" instance, "),n("em",[n("strong",[e._v("url")])]),e._v(" is the downloading file url.")]),e._v(" "),n("p",[e._v("If "),n("em",[n("strong",[e._v("p2pConfig")])]),e._v(" is specified, then the default options (shown below) will be overridden.")]),e._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[e._v("Field")]),e._v(" "),n("th",{staticStyle:{"text-align":"center"}},[e._v("Type")]),e._v(" "),n("th",{staticStyle:{"text-align":"center"}},[e._v("Default")]),e._v(" "),n("th",{staticStyle:{"text-align":"center"}},[e._v("Description")])])]),e._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("logLevel")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("string|boolean")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("'error'")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Print log level(warn, error, none，false=none, true=warn).")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("token")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("string")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("undefined")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[n("RouterLink",{attrs:{to:"/en/views/bindings.html"}},[e._v("token")]),e._v("is used to summarize and display multi domain name data on the console. In addition, token is required while customizing channelId.")],1)]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("trackerZone")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("string")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("'eu'")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("The country code name of the tracker server address('eu', 'hk', 'us').")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("p2pEnabled")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("boolean")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("true")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Enable or disable p2p engine.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("webRTCConfig")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Object")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("{}")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("A "),n("a",{attrs:{href:"https://github.com/feross/simple-peer",target:"_blank",rel:"noopener noreferrer"}},[e._v("Configuration dictionary"),n("OutboundLink")],1),e._v(" providing options to configure WebRTC connections.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("pieceLength")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("number")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("1024 * 1024")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Length in bytes of every piece but the last one.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("httpMaxRetrys")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("number")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("2")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Maximum retry times of file download by HTTP.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("showSlogan")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("boolean")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("false")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Display slogan of cdnbye on console.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("mitm")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("string")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("'https://cdnbye.github.io/file-p2p-engine/demo/mitm.html'")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("The address of own man in the middle that installs the service worker in a secure context hosted on github static pages from an iframe.")])]),e._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[e._v("diskCacheLimit")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Object")]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v('{"pc": 2500 * 1024 * 1024, "mobile": 1500 * 1024 * 1024}')]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("The max size of binary data that can be stored in the disk cache.")])])])]),e._v(" "),n("h2",{attrs:{id:"p2penginefile-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#p2penginefile-api"}},[e._v("#")]),e._v(" P2PEngineFile API")]),e._v(" "),n("h4",{attrs:{id:"p2penginefile-version-static"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#p2penginefile-version-static"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("P2PEngineFile.version")])]),e._v(" (static)")]),e._v(" "),n("p",[e._v("Get the version of P2PEngineFile.")]),e._v(" "),n("h4",{attrs:{id:"p2penginefile-protocolversion-static"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#p2penginefile-protocolversion-static"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("P2PEngineFile.protocolVersion")])]),e._v(" (static)")]),e._v(" "),n("p",[e._v("Get the version of P2P protocol.")]),e._v(" "),n("h4",{attrs:{id:"p2penginefile-issupported-static-method"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#p2penginefile-issupported-static-method"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("P2PEngineFile.isSupported() (static method)")])])]),e._v(" "),n("p",[e._v("Returns true if WebRTC data channel is supported by the browser.")]),e._v(" "),n("h4",{attrs:{id:"engine-start"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-start"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.start()")])])]),e._v(" "),n("p",[e._v("Start file download.")]),e._v(" "),n("h4",{attrs:{id:"engine-pause"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-pause"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.pause()")])])]),e._v(" "),n("p",[e._v("Pause file download.")]),e._v(" "),n("h4",{attrs:{id:"engine-resume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-resume"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.resume()")])])]),e._v(" "),n("p",[e._v("Resume file download.")]),e._v(" "),n("h4",{attrs:{id:"engine-stop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-stop"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.stop()")])])]),e._v(" "),n("p",[e._v("Stop downloading and p2p, free used resources.")]),e._v(" "),n("h4",{attrs:{id:"engine-destroy"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-destroy"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.destroy()")])])]),e._v(" "),n("p",[e._v("Stop downloading and p2p, free used resources.")]),e._v(" "),n("h4",{attrs:{id:"engine-issavebystreamsupported"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-issavebystreamsupported"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.isSaveByStreamSupported")])])]),e._v(" "),n("p",[e._v("Returns true if save file by ServiceWorker stream is supported by the browser.")]),e._v(" "),n("h4",{attrs:{id:"engine-savebyserviceworkerstream-filename"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-savebyserviceworkerstream-filename"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.saveByServiceWorkerStream(filename)")])])]),e._v(" "),n("p",[e._v("Instruct the browser to save a file using some response header + service worker.")]),e._v(" "),n("h2",{attrs:{id:"p2penginefile-events"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#p2penginefile-events"}},[e._v("#")]),e._v(" P2PEngineFile Events")]),e._v(" "),n("h4",{attrs:{id:"engine-on-metadata-function-source"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-metadata-function-source"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('metadata', function (source) {})")])])]),e._v(" "),n("p",[e._v("Get the metadata of file，including: "),n("br"),e._v("\nsource.getUrl()：The download address of file "),n("br"),e._v("\nsource.getMime()：The mime type of file "),n("br"),e._v("\nsource.getFileLength()：The size of file "),n("br")]),e._v(" "),n("h4",{attrs:{id:"engine-on-progress-function-ratio"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-progress-function-ratio"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('progress', function (ratio) {})")])])]),e._v(" "),n("p",[e._v("Download progress.")]),e._v(" "),n("h4",{attrs:{id:"engine-on-failed-function"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-failed-function"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('failed', function () {})")])])]),e._v(" "),n("p",[e._v("Emitted when download failed, do something like fallback to normal download.")]),e._v(" "),n("h4",{attrs:{id:"engine-on-speed-function-speed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-speed-function-speed"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('speed', function (speed) {})")])])]),e._v(" "),n("p",[e._v("Mean download speed(byte/s).")]),e._v(" "),n("h4",{attrs:{id:"engine-on-finished-function-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-finished-function-file"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('finished', function (file) {})")])])]),e._v(" "),n("p",[e._v("Emitted when download finished, file is an object to handle the downloaded file, including: "),n("br"),e._v("\nfile.save(fileName)：Save file with fileName "),n("br"),e._v("\nfile.getBlobURL()：Get the blob URL "),n("br"),e._v("\nfile.revokeBlobURL()：Remove reference to BlobURL and free used resources "),n("br")]),e._v(" "),n("h4",{attrs:{id:"engine-on-peerid-function-peerid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-peerid-function-peerid"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('peerId', function (peerId) {})")])])]),e._v(" "),n("p",[e._v("Emitted when the peer Id of this client is obtained from server.")]),e._v(" "),n("h4",{attrs:{id:"engine-on-peers-function-peers"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-peers-function-peers"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('peers', function (peers) {})")])])]),e._v(" "),n("p",[e._v("Emitted when successfully connected with new peer.")]),e._v(" "),n("h4",{attrs:{id:"engine-on-stats-function-stats"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-stats-function-stats"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('stats', function (stats) {})")])])]),e._v(" "),n("p",[e._v("Emitted when data is downloaded/uploaded."),n("br"),e._v("\nstats.totalHTTPDownloaded: total data downloaded by HTTP(KB)."),n("br"),e._v("\nstats.totalP2PDownloaded: total data downloaded by P2P(KB)."),n("br"),e._v("\nstats.totalP2PUploaded: total data uploaded by P2P(KB)."),n("br"),e._v("\nstats.p2pDownloadSpeed: p2p download speed(KB/s).")]),e._v(" "),n("h3",{attrs:{id:"engine-on-serverconnected-function-connected"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-serverconnected-function-connected"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('serverConnected', function (connected) {})")])])]),e._v(" "),n("p",[e._v("Emitted when websocket is opened/closed.")]),e._v(" "),n("h3",{attrs:{id:"engine-on-exception-function-e"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#engine-on-exception-function-e"}},[e._v("#")]),e._v(" "),n("em",[n("strong",[e._v("engine.on('exception', function (e) {})")])])]),e._v(" "),n("p",[e._v("Emitted when exception occured."),n("br"),e._v("\ne.code: Exception identifier（TRACKER_EXPT SIGNAL_EXPT）"),n("br"),e._v("\ne.message: Exception message "),n("br"),e._v("\ne.stack: Exception stack "),n("br")]),e._v(" "),n("h3",{attrs:{id:"get-p2p-information-from-p2pconfig"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#get-p2p-information-from-p2pconfig"}},[e._v("#")]),e._v(" Get p2p information from p2pConfig")]),e._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[e._v("p2pConfig"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("getStats")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("totalP2PDownloaded"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" totalP2PUploaded"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" totalHTTPDownloaded"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" p2pDownloadSpeed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// get the downloading statistics")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("getPeerId")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("peerId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// get peer Id")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("getPeersInfo")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("peers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// get peers information")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("h2",{attrs:{id:"advanced-usage"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#advanced-usage"}},[e._v("#")]),e._v(" Advanced Usage")]),e._v(" "),n("h4",{attrs:{id:"dynamic-file-url-path-support"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-file-url-path-support"}},[e._v("#")]),e._v(" Dynamic File URL Path Support")]),e._v(" "),n("p",[e._v("Some urls point to the same file but have different paths on them. For example,\nexample.com/clientId1/fileId.file and example.com/clientId2/fileId.file. In this case, you can format a common channelId for them.")]),e._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Set token in p2pConfig before setting channelId!")]),e._v("\np2pConfig"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    token"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[e._v("YOUR_TOKEN")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[e._v("channelId")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("function")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" fileId "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("extractFileIdFromUrl")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// make a channelId by removing the different part which is defined by yourself")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" fileId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// channelId: VIDEO_ID       // for fixed channel id")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);