(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{505:function(e,n,t){},555:function(e,n,t){"use strict";t(505)},580:function(e,n,t){"use strict";t.r(n);var a=t(36),i=(t(551),t(10),t(17),t(19),t(25),t(58),t(26),t(32),t(29),t(134)),o=t(554),r=[{lon:114.16546,lat:22.27534,name:"hk"},{lon:121.4581,lat:31.2222,name:"sh"},{lon:104.0667,lat:30.6667,name:"cd"},{lon:116.3883,lat:39.9289,name:"pk"},{lon:-122.0575,lat:37.3874,name:"us"},{lon:8.6843,lat:50.1188,name:"ge"},{lon:139.6503,lat:35.6761,name:"jp"},{lon:126.978,lat:37.5665,name:"kr"},{lon:-46.6333,lat:-23.5505,name:"br"},{lon:103.82,lat:1.3521,name:"sg"},{lon:2.32141,lat:48.8714,name:"fr"}],l={0:"#B22222",1:"#33ff33",2:"#218868",3:"#1C86EE",4:"#FFD700",5:"#FF7F00",6:"#B22222",7:"#8C1EB2"},s=!1,c=[],u=new Map,m={name:"GeoFly",data:function(){return{scene:null,flyLineTimer:null,resizing:!1,resizingTimer:null}},mounted:function(){var e=this;"dark"!==(localStorage.getItem("mode")||this.$themeConfig.mode)&&(localStorage.setItem("mode","dark"),Object(i.j)());var n=new L7.Scene({logoVisible:!1,id:"map",map:new L7.Earth({style:"blank"})});this.scene=n,n.setBgColor("#181818");var t=(new L7.EarthLayer).source("https://gw.alipayobjects.com/mdn/rms_23a451/afts/img/A*3-3NSpqRqUoAAAAAAAAAAAAAARQnAQ",{parser:{type:"image"}}).color("#2E8AE6").shape("fill").style({opacity:1,globelOtions:{ambientRatio:.6,diffuseRatio:.4,specularRatio:.1}}).animate(!0),a=(new L7.EarthLayer).color("#2E8AE6").shape("atomSphere").style({opacity:1}),o=new L7.LineLayer({blend:"normal"}).size(.1).shape("arc3d").color("color").animate({enable:!0,interval:.3,trailLength:.2,duration:2.5});!function n(t){e.flyLineTimer=setTimeout((function(){s&&!e.resizing&&(o.setData(c,{parser:{type:"json",x:"lon1",y:"lat1",x1:"lon2",y1:"lat2"}}),s=!1);var t=c.length;n(t<100?200:t<500?3e3:t<1e3?5e3:t<2e3?1e4:2e4)}),t)}(200);var l=(new L7.PointLayer).source(r,{parser:{type:"json",x:"lon",y:"lat"}}).shape("triangle").color("#12e327").size(15).active(!0);n.on("loaded",(function(){n.addLayer(t),n.addLayer(l),n.addLayer(a),n.addLayer(o),e.setupServerUrl("wss://cn.cdnbye.com/flyline?uid=0"),e.setupServerUrl("wss://hk.swarmcloud.net/flyline?uid=0"),e.setupServerUrl("wss://tracker.hdtvcloud.com/flyline?uid=0")})),this.setupListener()},methods:{setupServerUrl:function(e){var n=this.$route.query.admin_token;n&&(e="".concat(e,"&admin_token=").concat(n));var t=this.setupDataSource(e);u.set(e,t)},convert:function(e){var n=[],t=e.from,a=e.to;return t&&a?(0===a.length||a.forEach((function(e){e.typ||(e.typ=0),n.push({lat1:t.lat,lon1:t.lon,lat2:e.lat,lon2:e.lon,color:l[e.typ]})})),n):n},setupListener:function(){var e=this,n=this.scene;n.on("movestart",(function(){e.handleResizing()})),n.on("zoomchange",(function(){e.handleResizing()})),n.on("zoomstart",(function(){e.handleResizing()})),n.on("dragging",(function(){e.handleResizing()}))},handleResizing:function(){var e=this;this.resizingTimer||(this.resizing=!0,this.resizingTimer=setTimeout((function(){e.resizing=!1,e.resizingTimer=null}),2e3))},setupDataSource:function(e){var n=this,t=new o.a(e,void 0,{maxRetries:5,minReconnectionDelay:2e4,maxReconnectionDelay:6e4});return t.addEventListener("open",(function(){})),t.addEventListener("message",(function(e){var t,i,o=e.data;try{i=JSON.parse(o)}catch(e){return void alert(o)}var r=n.convert(i);(t=c).push.apply(t,Object(a.a)(r)),c.length>7e3&&(c=c.slice(-7e3)),s=!0})),t}},beforeDestroy:function(){clearTimeout(this.flyLineTimer),clearTimeout(this.resizingTimer),this.scene&&this.scene.destroy(),u.forEach((function(e,n,t){e.close(1e3,"normal close")})),u.clear(),c=[]}},d=(t(555),t(1)),h=Object(d.a)(m,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,n=this._self._c||e;return n("div",[n("div",{attrs:{id:"map"}})])}],!1,null,null,null);n.default=h.exports}}]);