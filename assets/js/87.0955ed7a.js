(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{855:function(t,e,a){"use strict";a.r(e);var v=a(1),s=Object(v.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",[t._v("去中心化静态资源加速网络。")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.npmjs.com/package/swarmcloud-sw"}},[a("img",{attrs:{src:"https://img.shields.io/npm/v/swarmcloud-sw.svg?style=flat",alt:"npm"}})]),t._v(" "),a("a",{attrs:{href:"https://www.jsdelivr.com/package/npm/swarmcloud-sw"}},[a("img",{attrs:{src:"https://data.jsdelivr.com/v1/package/npm/swarmcloud-sw/badge",alt:"jsdelivr"}})])]),t._v(" "),a("p",[t._v("SW P2P Engine 采用最先进的HTML5技术——WebRTC来做点对点传输，ServiceWorker来代理网络请求，还有IndexedDB来缓存数据，打造了一个去中心化的静态资源加速网络。在不影响用户体验的前提下，利用终端设备的闲置带宽和少量的磁盘空间，创造一个可无限扩展的P2P网络，大幅节省网站的CDN成本。")]),t._v(" "),a("h3",{attrs:{id:"特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),a("ul",[a("li",[t._v("浏览器原生支持，不需要安装任何插件，采用仿BT算法，在线人数越多效果越好")]),t._v(" "),a("li",[t._v("支持大部分静态文件类型，包括js、css、图片和音频等")]),t._v(" "),a("li",[t._v("智能缓存和预加载资源")]),t._v(" "),a("li",[t._v("数据加密传输")]),t._v(" "),a("li",[t._v("浏览器不支持WebRTC时无缝切换到HTTP下载模式")]),t._v(" "),a("li",[t._v("可与所有CDN搭配使用，无需改造服务端")]),t._v(" "),a("li",[t._v("Tracker服务器根据访问IP的ISP、地域等进行智能调度")])]),t._v(" "),a("h3",{attrs:{id:"浏览器支持情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器支持情况"}},[t._v("#")]),t._v(" 浏览器支持情况")]),t._v(" "),a("p",[t._v("由于WebRTC已成为HTML5标准，目前大部分主流浏览器都已经支持。兼容性取决于浏览器是否支持 WebRTC, ServiceWorker 和 IndexedDB。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("兼容性")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Chrome")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Firefox")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Mac Safari")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("安卓微信/QQ")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Opera")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Edge")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("iOS Safari")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("IE")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("WebRTC")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("❌")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("Service Worker")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("❌")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("IndexedDB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("❌")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("SwarmCloud")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("✔")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("❌")])])])]),t._v(" "),a("h3",{attrs:{id:"工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作原理"}},[t._v("#")]),t._v(" 工作原理")]),t._v(" "),a("ul",[a("li",[t._v("首先由客户端嵌入的js库 "),a("em",[a("strong",[t._v("sw-p2p-engine")])]),t._v(" 注册 ServiceWorker")]),t._v(" "),a("li",[t._v("ServiceWorker 通过监听 fetch 事件，拦截全站的网络请求，并将可缓存的静态资源（如 https://yourwebsite.com/kitty.png）保存在 IndexedDB 中")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fetch'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* ⛦ magic here ⛦ */")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ul",[a("li",[t._v("判断一个网络请求是否可缓存的依据是：\n"),a("ul",[a("li",[t._v("响应头包含缓存相关的字段，如 Cache-Control 或者 Expires")]),t._v(" "),a("li",[t._v("目标资源是允许缓存的静态资源（如 jpg, png, js, css, mp3等）")])])]),t._v(" "),a("li",[t._v("一旦网络响应被视为可缓存的，在后台工作线程中，PeerWorker会分别对这些资源进行缓存、索引、切片、加密以及通过P2P网络进行分发")]),t._v(" "),a("li",[t._v("当资源被一个设备缓存之后，其他设备在请求相同资源时，将尝试优先通过P2P网络就近从该设备获取资源，而不是从成本更高、距离更远的源服务器获取（即用WebRTC替代HTTP）")]),t._v(" "),a("li",[t._v("从P2P网络获取失败或者不能缓存的资源，将自动回源")])]),t._v(" "),a("h3",{attrs:{id:"最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),a("ul",[a("li",[t._v("准备工作\n"),a("ul",[a("li",[t._v("为网站申请HTTPS证书")]),t._v(" "),a("li",[t._v("在CDNBye控制台注册账号并在 "),a("em",[a("strong",[t._v("网站管理")])]),t._v(" 界面添加域名")])])]),t._v(" "),a("li",[t._v("将 SDK 放在网站入口页面，比如网站的首页")]),t._v(" "),a("li",[t._v("将用户的 http 访问请求自动跳转到 https ，从而保证 P2P 可以正常工作")]),t._v(" "),a("li",[t._v("用户在内嵌 SDK 的页面点击跳转到其他页面时，在新的tab打开页面，保持原页面不被覆盖")]),t._v(" "),a("li",[t._v("尽量将图片等资源放在当前域名下，减少跨域配置等额外工作量")]),t._v(" "),a("li",[t._v("如果不得不使用第三方域名的资源（比如阿里云的CDN加速），请记得在CDN配置跨域头，并且在 SDK 侧将第三方域名加入白名单，详细步骤请参考"),a("RouterLink",{attrs:{to:"/cn/views/sw/API.html#第三方资源加速"}},[t._v("这里")])],1),t._v(" "),a("li",[t._v("中长视频和大文件等体积较大的资源不适合使用本 SDK 加速")])])])}),[],!1,null,null,null);e.default=s.exports}}]);